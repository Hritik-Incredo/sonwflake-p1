USE DATABASE PORTS_DB;



-- carrier handled per terminal 

SELECT
TERMINAL_ID,
COUNT(*) AS CONTAINER_COUNT,
FROM GOLD.FACT_CONTAINER_MOVEMENT
GROUP BY terminal_id;

-- average dwell time by carrier

SELECT
carrier,
AVG(dwell_hours) AS avg_dwell_hours
FROM GOLD.FACT_CONTAINER_MOVEMENT
GROUP BY carrier;


-- customs clearance status

SELECT
clearance_status,
count(*) AS total_containers
FROM GOLD.FACT_CONTAINER_MOVEMENT
GROUP BY clearance_status;





SELECT * FROM BRONZE.CONTAINER_MOVEMENT_RAW;

SELECT * FROM task_stream.CONTAINER_MOVEMENT_RAW_STREAM;

SELECT * FROM silver.container_movement_transformed;

SELECT * FROM task_stream.CONTAINER_MOVEMENT_TRANSFORMED_STREAM;

SELECT * FROM SILVER.CONTAINER_MOVEMENT_TRANSFORMED_CLEAN;

SELECT * FROM SILVER.CONTAINER_MOVEMENT_TRANSFORMED_ERROR;

SELECT * FROM GOLD.FACT_CONTAINER_MOVEMENT;

SELECT * FROM GOLD.DAILY_CONTAINER_THROUGHPUT;



SELECT * FROM INFORMATION_SCHEMA.TASK_HISTORY(
    TASK_NAME => 'task_stream.CONTAINER_MOVEMENT_RAW_TASK',
    START_TIME_RANGE_START => DATEADD('hour', -2, CURRENT_TIMESTAMP)    
);





LIST @BRONZE.SNOW_FILES;


DESC FILE FORMAT BRONZE.CSV_FORMAT;



SHOW TASKS IN DATABASE PORTS_DB;
SHOW STREAMS IN DATABASE PORTS_DB;
